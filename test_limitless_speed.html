<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Limitless Speed Auto Scroll</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body class="bg-gray-100 p-8">
    <div class="max-w-4xl mx-auto">
        <h1 class="text-3xl font-bold text-gray-900 mb-8">Test Limitless Speed Auto Scroll</h1>
        
        <!-- Speed Information Panel -->
        <div id="speed-info" class="bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8">
            <h2 class="text-xl font-semibold mb-4">Speed Information</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="bg-blue-50 p-4 rounded-lg">
                    <div class="text-sm text-blue-600 font-medium">Current Speed</div>
                    <div id="current-speed" class="text-2xl font-bold text-blue-800">33 px/s</div>
                </div>
                <div class="bg-green-50 p-4 rounded-lg">
                    <div class="text-sm text-green-600 font-medium">Speed Category</div>
                    <div id="speed-category" class="text-2xl font-bold text-green-800">Sedang</div>
                </div>
                <div class="bg-purple-50 p-4 rounded-lg">
                    <div class="text-sm text-purple-600 font-medium">Speed Step</div>
                    <div id="speed-step" class="text-2xl font-bold text-purple-800">5 px/s</div>
                </div>
            </div>
            
            <!-- Speed Controls -->
            <div class="mt-6 flex flex-wrap gap-4 items-center">
                <button id="speed-test-decrease" class="px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg transition duration-200">
                    <i class="fas fa-minus mr-2"></i>Kurangi Speed
                </button>
                <button id="speed-test-increase" class="px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition duration-200">
                    <i class="fas fa-plus mr-2"></i>Tambah Speed
                </button>
                <button id="speed-test-reset" class="px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-lg transition duration-200">
                    <i class="fas fa-undo mr-2"></i>Reset
                </button>
                <button id="speed-test-extreme" class="px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition duration-200">
                    <i class="fas fa-rocket mr-2"></i>Test Extreme (500px/s)
                </button>
            </div>
            
            <!-- Speed Limits Info -->
            <div class="mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
                <h3 class="text-yellow-800 font-medium mb-2">Limitless Speed System</h3>
                <ul class="text-sm text-yellow-700 space-y-1">
                    <li>• <strong>Minimum:</strong> 5 px/s (ada batas minimum untuk usability)</li>
                    <li>• <strong>Maximum:</strong> Tidak ada batas! Bisa sampai ribuan px/s</li>
                    <li>• <strong>Step:</strong> 5 px/s per klik (dapat dikustomisasi)</li>
                    <li>• <strong>Categories:</strong> Lambat (≤25), Sedang (26-50), Cepat (51-100), Sangat Cepat (101-200), Ekstrem (>200)</li>
                </ul>
            </div>
        </div>
        
        <!-- Test Content -->
        <div id="quran-content" class="bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8">
            <div class="ayat-container mb-8">
                <div class="arabic-text text-right text-3xl mb-4" dir="rtl">
                    بِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ
                </div>
                <div class="transliteration-content text-gray-700 italic mb-4">
                    <span class="text-xs uppercase tracking-wide text-gray-500 font-normal block mb-1">Transliterasi:</span>
                    Bismillahir rahmanir rahiim
                </div>
                <div class="translation-content text-gray-800">
                    <span class="text-xs uppercase tracking-wide text-gray-500 font-medium block mb-2">Terjemahan:</span>
                    Dengan nama Allah Yang Maha Pengasih, Maha Penyayang.
                </div>
            </div>
            
            <!-- Long content for testing scroll -->
            <div style="height: 3000px; background: linear-gradient(to bottom, #f9fafb, #e5e7eb, #d1d5db, #9ca3af); display: flex; align-items: center; justify-content: center; color: #6b7280; flex-direction: column; gap: 20px;">
                <p class="text-2xl font-bold">Konten Panjang untuk Testing Limitless Speed</p>
                <p>Scroll speed sekarang bisa unlimited!</p>
                <p>Coba tekan tombol + berkali-kali untuk melihat speed naik terus</p>
                <div class="mt-8 p-4 bg-white rounded-lg shadow">
                    <p class="text-sm">Tips: Gunakan keyboard shortcuts:</p>
                    <ul class="text-sm mt-2 space-y-1">
                        <li>• <kbd class="px-2 py-1 bg-gray-200 rounded">Space</kbd> - Toggle auto scroll</li>
                        <li>• <kbd class="px-2 py-1 bg-gray-200 rounded">+</kbd> - Increase speed</li>
                        <li>• <kbd class="px-2 py-1 bg-gray-200 rounded">-</kbd> - Decrease speed</li>
                        <li>• <kbd class="px-2 py-1 bg-gray-200 rounded">Esc</kbd> - Close panels</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Auto Scroll Floating Button (Simplified Design) -->
    <div id="auto-scroll-floating" class="fixed bottom-6 right-6 z-50 transition-all duration-300 ease-in-out">
        <!-- Speed Decrease Button (Orange) -->
        <button id="speed-decrease-floating" 
                class="w-12 h-12 bg-orange-600 hover:bg-orange-700 text-white rounded-full shadow-lg transition-all duration-200 ease-in-out flex items-center justify-center mb-2"
                title="Perlambat scroll"
                aria-label="Decrease scroll speed">
            <i class="fas fa-minus text-sm"></i>
        </button>
        
        <!-- Speed Increase Button (Blue) -->
        <button id="speed-increase-floating" 
                class="w-12 h-12 bg-blue-600 hover:bg-blue-700 text-white rounded-full shadow-lg transition-all duration-200 ease-in-out flex items-center justify-center mb-2"
                title="Percepat scroll"
                aria-label="Increase scroll speed">
            <i class="fas fa-plus text-sm"></i>
        </button>
        
        <!-- Main Auto Scroll Button (Green) -->
        <button id="auto-scroll-main-btn" 
                class="w-14 h-14 bg-green-600 hover:bg-green-700 text-white rounded-full shadow-lg transition-all duration-200 ease-in-out flex items-center justify-center mb-2"
                title="Auto Scroll"
                aria-label="Toggle auto scroll">
            <i id="auto-scroll-icon" class="fas fa-play text-lg group-hover:scale-110 transition-transform duration-200"></i>
        </button>
        
        <!-- Display Options Button (Purple) -->
        <button id="display-options-btn" 
                class="w-12 h-12 bg-purple-600 hover:bg-purple-700 text-white rounded-full shadow-lg transition-all duration-200 ease-in-out flex items-center justify-center"
                title="Pengaturan tampilan"
                aria-label="Toggle display options">
            <i class="fas fa-eye text-sm"></i>
        </button>
        
        <!-- Speed Indicator -->
        <div id="speed-indicator-floating" class="absolute -left-20 top-1/2 transform -translate-y-1/2 bg-gray-800 text-white px-3 py-2 rounded text-xs font-medium opacity-0 invisible transition-all duration-300">
            <span id="speed-text">Sedang</span>
        </div>
        
        <!-- Display Options Panel -->
        <div id="display-options-panel" class="absolute bottom-0 right-16 bg-white rounded-lg shadow-lg border border-gray-200 p-3 min-w-[180px] opacity-0 invisible transform translate-x-2 transition-all duration-300 ease-in-out">
            <h4 class="text-xs font-medium text-gray-700 mb-3 uppercase tracking-wide">Tampilan</h4>
            
            <div class="space-y-2">
                <label class="flex items-center gap-2 cursor-pointer">
                    <input type="checkbox" id="show-transliteration" checked class="w-4 h-4 text-purple-600 rounded">
                    <span class="text-sm text-gray-700">Transliterasi</span>
                </label>
                
                <label class="flex items-center gap-2 cursor-pointer">
                    <input type="checkbox" id="show-translation" checked class="w-4 h-4 text-purple-600 rounded">
                    <span class="text-sm text-gray-700">Terjemahan</span>
                </label>
                
                <label class="flex items-center gap-2 cursor-pointer">
                    <input type="checkbox" id="show-tafsir" checked class="w-4 h-4 text-purple-600 rounded">
                    <span class="text-sm text-gray-700">Tafsir/Catatan</span>
                </label>
            </div>
            
            <div class="border-t border-gray-200 pt-3 mt-3">
                <button id="reset-display-options" 
                        class="w-full px-3 py-2 text-xs font-medium text-gray-600 hover:text-gray-800 hover:bg-gray-50 rounded-md transition-all duration-200 flex items-center justify-center gap-1"
                        title="Reset tampilan"
                        aria-label="Reset display options">
                    <i class="fas fa-undo text-xs"></i>
                    Reset
                </button>
            </div>
        </div>
    </div>

    <!-- Load JavaScript files -->
    <script src="assets/js/settings-manager.js"></script>
    <script src="assets/js/scroll-engine.js"></script>
    <script src="assets/js/scroll-status-indicator.js"></script>
    <script src="assets/js/auto-scroll-component.js"></script>

    <script>
        // Initialize AutoScrollComponent and test limitless speed
        document.addEventListener('DOMContentLoaded', function() {
            const quranContent = document.getElementById('quran-content');
            
            if (quranContent && quranContent.children.length > 0) {
                // Initialize the auto scroll component
                const autoScrollComponent = new AutoScrollComponent('auto-scroll-floating');
                
                // Store reference globally
                window.autoScrollComponent = autoScrollComponent;
                
                // Update speed info display
                function updateSpeedInfo() {
                    if (!window.autoScrollComponent) return;
                    
                    const state = window.autoScrollComponent.scrollEngine.getState();
                    const currentSpeed = state.currentSpeed;
                    
                    // Update current speed
                    document.getElementById('current-speed').textContent = currentSpeed + ' px/s';
                    
                    // Update speed category
                    let category = '';
                    if (currentSpeed <= 25) {
                        category = 'Lambat';
                    } else if (currentSpeed <= 50) {
                        category = 'Sedang';
                    } else if (currentSpeed <= 100) {
                        category = 'Cepat';
                    } else if (currentSpeed <= 200) {
                        category = 'Sangat Cepat';
                    } else {
                        category = 'Ekstrem';
                    }
                    document.getElementById('speed-category').textContent = category;
                    
                    // Update speed step
                    document.getElementById('speed-step').textContent = state.speedStep + ' px/s';
                }
                
                // Test controls
                document.getElementById('speed-test-increase').addEventListener('click', function() {
                    window.autoScrollComponent.scrollEngine.increaseSpeed();
                    updateSpeedInfo();
                });
                
                document.getElementById('speed-test-decrease').addEventListener('click', function() {
                    window.autoScrollComponent.scrollEngine.decreaseSpeed();
                    updateSpeedInfo();
                });
                
                document.getElementById('speed-test-reset').addEventListener('click', function() {
                    window.autoScrollComponent.scrollEngine.resetToDefaults();
                    updateSpeedInfo();
                });
                
                document.getElementById('speed-test-extreme').addEventListener('click', function() {
                    // Set extreme speed directly
                    window.autoScrollComponent.scrollEngine.customSpeed = 500;
                    window.autoScrollComponent.scrollEngine.currentSpeed = 500;
                    window.autoScrollComponent.scrollEngine.updateSpeedPreset();
                    window.autoScrollComponent.scrollEngine.saveCurrentSettings();
                    updateSpeedInfo();
                    
                    // Show warning
                    alert('Speed set to 500px/s! This is extremely fast. Use with caution!');
                });
                
                // Listen for speed changes
                document.addEventListener('scrollEngine:speedChange', function() {
                    updateSpeedInfo();
                });
                
                // Initial update
                updateSpeedInfo();
                
                console.log('Limitless Speed Auto Scroll initialized!');
                console.log('Current settings:', window.autoScrollComponent.scrollEngine.getCurrentSettings());
            }
        });
        
        // Test function to demonstrate limitless capability
        function testLimitlessSpeed() {
            if (!window.autoScrollComponent) {
                alert('Auto scroll component not initialized!');
                return;
            }
            
            const engine = window.autoScrollComponent.scrollEngine;
            let testSpeed = 60; // Start from old limit
            
            console.log('Testing limitless speed capability...');
            
            // Test increasing speed beyond old limit
            for (let i = 0; i < 20; i++) {
                engine.increaseSpeed();
                testSpeed += 5;
            }
            
            const finalSpeed = engine.getCurrentSpeed();
            console.log(`Final speed after 20 increases: ${finalSpeed}px/s`);
            console.log(`Old limit was 60px/s, new speed is ${finalSpeed}px/s`);
            
            if (finalSpeed > 60) {
                console.log('✅ Limitless speed test PASSED!');
                alert(`Limitless speed test PASSED!\nOld limit: 60px/s\nNew speed: ${finalSpeed}px/s`);
            } else {
                console.log('❌ Limitless speed test FAILED!');
                alert('Limitless speed test FAILED!');
            }
        }
        
        // Add test button
        setTimeout(() => {
            const testButton = document.createElement('button');
            testButton.textContent = 'Test Limitless Speed';
            testButton.className = 'fixed top-4 right-4 px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg shadow-lg z-50';
            testButton.onclick = testLimitlessSpeed;
            document.body.appendChild(testButton);
        }, 1000);
    </script>

    <style>
        /* Auto Scroll Floating Button Styles */
        #auto-scroll-floating {
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }

        #auto-scroll-floating button {
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }

        /* Main button hover effects */
        #auto-scroll-main-btn:hover {
            transform: scale(1.05);
        }

        #auto-scroll-main-btn:active {
            transform: scale(0.95);
        }

        /* Speed control buttons hover effects */
        #speed-increase-floating:hover,
        #speed-decrease-floating:hover {
            transform: scale(1.05);
        }

        #speed-increase-floating:active,
        #speed-decrease-floating:active {
            transform: scale(0.95);
        }

        /* Display options button hover effects */
        #display-options-btn:hover {
            transform: scale(1.05);
        }

        #display-options-btn:active {
            transform: scale(0.95);
        }

        /* Speed indicator floating */
        #speed-indicator-floating.show {
            opacity: 1;
            visibility: visible;
        }

        /* Display options panel */
        #display-options-panel.show {
            opacity: 1;
            visibility: visible;
            transform: translateX(0);
        }

        /* Paused state styling */
        #auto-scroll-main-btn.paused {
            background-color: #f59e0b !important;
        }

        #auto-scroll-main-btn.paused:hover {
            background-color: #d97706 !important;
        }

        /* Temporarily disabled state styling */
        #auto-scroll-main-btn.temporarily-disabled {
            background-color: #f97316 !important;
            opacity: 0.7;
        }

        #auto-scroll-main-btn.temporarily-disabled:hover {
            background-color: #ea580c !important;
        }

        /* Content visibility controls */
        .transliteration-content.hidden {
            display: none !important;
        }

        .translation-content.hidden {
            display: none !important;
        }

        .tafsir-content.hidden {
            display: none !important;
        }

        /* Smooth transitions for content visibility */
        .transliteration-content,
        .translation-content,
        .tafsir-content {
            transition: opacity 0.3s ease, transform 0.3s ease;
        }

        .transliteration-content.hiding,
        .translation-content.hiding,
        .tafsir-content.hiding {
            opacity: 0;
            transform: translateY(-10px);
        }

        /* Pulse animation for active state */
        @keyframes pulse-green {
            0%, 100% {
                box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7);
            }
            50% {
                box-shadow: 0 0 0 10px rgba(16, 185, 129, 0);
            }
        }

        #auto-scroll-main-btn.active {
            animation: pulse-green 2s infinite;
        }

        /* Focus styles for accessibility */
        #auto-scroll-floating button:focus {
            outline: 2px solid #3b82f6;
            outline-offset: 2px;
        }

        /* Mobile responsive adjustments */
        @media (max-width: 640px) {
            #auto-scroll-floating {
                bottom: 1rem;
                right: 1rem;
            }
            
            #auto-scroll-main-btn {
                width: 3.5rem;
                height: 3.5rem;
            }
        }

        /* Keyboard shortcuts styling */
        kbd {
            font-family: monospace;
            font-size: 0.875rem;
        }
    </style>
</body>
</html>